// 📂 sendGeneralNotification.js
import { exec } from "child_process";
import fs from "fs";
import path from "path";

const jsonFilePath = path.join(process.cwd(), "generalNotification.json");

// ✅ Function to send general notification
export const sendGeneralNotification = () => {
  // 🌟 Create or overwrite the JSON file
  const notificationData = {
    title: "🌟 Stay Tuned for New Features!",
    message: `
      <div style="font-family: Arial, sans-serif; line-height: 1.6; text-align: center;">
      

        <svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 300 300"
  width="120" 
  height="120"
  fill="currentColor"
  className={className}
  style="display: block; margin: auto;"
>
  <g
    transform="translate(0.000000,300.000000) scale(0.100000,-0.100000)"
    fill="currentColor"
    stroke="none"
  >
        <path
          d="M1338 2549 c-259 -28 -490 -185 -631 -431 -91 -159 -128 -302 -129
    -498 -1 -171 22 -279 88 -413 120 -241 339 -409 598 -457 66 -12 241 -9 307 6
    24 5 32 -3 98 -99 l72 -104 296 199 c163 110 302 202 309 205 8 3 -20 46 -81
    123 l-94 118 25 61 c56 138 67 203 67 391 1 197 -14 273 -78 407 -163 345
    -485 532 -847 492z m275 -45 c133 -30 243 -92 357 -203 41 -39 70 -71 66 -71
    -4 0 5 -11 18 -25 68 -68 141 -226 167 -360 7 -38 13 -128 13 -200 0 -141 -17
    -242 -60 -355 -31 -84 -30 -96 9 -155 17 -27 38 -58 44 -69 7 -12 13 -17 13
    -12 0 6 14 -9 31 -32 30 -42 31 -43 13 -63 -10 -11 -33 -27 -51 -36 -18 -8
    -33 -19 -33 -24 0 -5 -5 -9 -11 -9 -6 0 -28 -14 -49 -30 -21 -17 -43 -30 -49
    -30 -6 0 -11 -3 -11 -8 0 -4 -17 -16 -37 -27 -20 -11 -41 -25 -47 -30 -10 -9
    -34 -25 -150 -101 -67 -44 -89 -55 -101 -50 -7 2 -33 35 -58 73 -71 109 -67
    107 -192 93 -116 -13 -178 -9 -298 21 -136 33 -227 86 -337 199 -111 113 -162
    195 -219 355 -29 83 -39 286 -21 418 20 139 105 341 184 434 20 25 134 139
    156 159 63 54 198 115 305 139 86 19 262 18 348 -1z"
        />
        <path
          d="M1337 2498 c-7 -4 -24 -8 -39 -8 -60 0 -248 -76 -298 -120 -9 -8 -42
    -35 -72 -60 -134 -110 -241 -297 -282 -494 -23 -111 -21 -312 3 -413 43 -179
    126 -307 310 -473 30 -27 135 -78 216 -105 123 -41 253 -44 425 -10 16 3 60
    -32 60 -48 0 -11 57 -86 80 -105 32 -26 67 -8 327 171 46 31 87 57 91 57 21 0
    92 80 92 104 0 15 -25 56 -65 107 -36 45 -65 87 -65 93 0 6 13 43 28 81 51
    125 67 215 66 375 0 151 -2 170 -29 260 -47 153 -117 269 -228 381 -141 141
    -333 219 -525 216 -46 -1 -89 -5 -95 -9z m266 -44 c271 -61 506 -318 568 -619
    18 -84 15 -304 -4 -391 -18 -78 -60 -196 -82 -231 -14 -21 -11 -28 65 -122 44
    -54 80 -101 80 -104 0 -4 -414 -285 -457 -311 -10 -5 -70 74 -137 181 -1 1
    -30 -6 -66 -14 -89 -22 -266 -21 -350 1 -250 67 -465 285 -537 546 -28 100
    -25 357 4 465 85 314 330 558 606 604 88 15 233 12 310 -5z"
        />
        <path
          d="M1360 2303 c-189 -31 -368 -177 -460 -376 -68 -143 -90 -355 -55
    -506 46 -193 212 -371 405 -432 105 -34 283 -26 392 16 12 5 29 -12 68 -70 28
    -42 55 -75 59 -73 4 2 69 43 143 92 l136 90 -56 70 c-30 39 -59 76 -64 83 -6
    7 3 30 23 63 55 89 81 188 87 331 6 154 -12 246 -68 364 -86 177 -230 299
    -402 340 -59 14 -152 18 -208 8z m210 -42 c75 -20 103 -33 165 -77 53 -37 134
    -114 120 -114 -3 0 8 -14 24 -31 151 -158 174 -551 45 -760 -12 -20 -24 -42
    -25 -50 -4 -19 10 -72 21 -79 17 -10 70 -83 70 -95 0 -11 -112 -91 -145 -104
    -5 -2 -23 -13 -38 -23 -27 -19 -29 -19 -48 -2 -11 10 -29 33 -40 51 -32 51
    -64 64 -119 46 -63 -20 -247 -29 -304 -14 -47 12 -157 58 -166 70 -3 4 -21 18
    -40 31 -19 14 -48 40 -65 59 -16 19 -40 46 -53 60 -29 33 -64 100 -88 171 -29
    84 -27 309 4 405 64 202 192 355 359 428 103 45 219 55 323 28z"
        />
        <path
          d="M1375 2250 c-99 -12 -222 -73 -281 -139 -15 -17 -31 -28 -35 -25 -5
    3 -9 1 -9 -4 0 -5 -20 -40 -45 -77 -68 -100 -95 -169 -120 -300 -10 -50 -6
    -186 7 -250 19 -101 73 -204 135 -261 13 -12 23 -26 23 -33 0 -6 4 -11 9 -11
    5 0 16 -6 23 -13 27 -26 115 -76 163 -94 73 -26 278 -24 356 3 67 24 88 19
    113 -29 18 -32 61 -67 83 -67 18 0 131 78 142 98 7 13 6 26 -4 45 -8 15 -12
    27 -9 27 3 0 -11 17 -30 37 -20 21 -36 44 -36 52 0 7 16 35 35 61 67 92 102
    244 92 408 -7 121 -35 215 -92 307 -125 202 -301 291 -520 265z m214 -47 c208
    -63 370 -311 371 -568 0 -151 -34 -267 -106 -365 l-44 -60 55 -68 c30 -37 54
    -71 54 -77 0 -5 -30 -29 -66 -51 l-67 -42 -48 69 c-27 38 -50 69 -51 69 -1 0
    -36 -12 -77 -26 -193 -68 -384 -33 -521 94 -114 105 -168 218 -176 372 -8 131
    14 237 74 358 123 250 360 366 602 295z"
        />
        <path
          d="M1350 2067 c-73 -23 -152 -135 -187 -262 -54 -200 -4 -455 112 -571
    83 -82 223 -86 320 -9 19 15 19 16 -13 47 l-31 32 87 51 87 50 7 60 c25 225
    18 313 -38 431 -70 149 -204 215 -344 171z m182 -41 c51 -24 99 -74 127 -130
    26 -53 62 -182 53 -190 -12 -13 -22 -5 -22 17 0 34 -26 116 -57 177 -49 100
    -173 156 -260 118 -36 -16 -99 -58 -87 -58 5 0 4 -4 -1 -8 -17 -11 -62 -121
    -76 -184 -8 -32 -18 -58 -23 -58 -14 0 2 74 32 153 30 78 94 154 147 174 40
    16 123 10 167 -11z m-22 -48 c78 -40 135 -144 154 -280 4 -35 3 -38 -19 -38
    -13 0 -27 -5 -31 -12 -5 -8 2 -9 24 -5 27 6 32 4 32 -13 0 -13 7 -20 20 -20
    11 0 20 -7 20 -15 0 -19 -24 -19 -42 -1 -19 18 -58 30 -58 17 0 -6 11 -13 25
    -17 25 -6 26 -8 19 -68 -4 -33 -10 -65 -15 -71 -4 -5 -53 -35 -108 -65 -55
    -30 -101 -59 -101 -65 0 -5 14 -24 32 -42 l32 -33 -45 0 c-24 0 -60 8 -79 18
    -73 36 -139 183 -143 320 -2 58 -5 72 -19 75 -16 5 -17 -3 -13 -70 7 -98 11
    -122 37 -191 25 -67 64 -126 96 -143 12 -7 22 -16 22 -21 0 -4 13 -8 29 -8 17
    0 32 -4 36 -9 7 -12 59 5 76 25 9 11 9 20 0 40 -15 34 -3 48 67 82 84 39 118
    77 126 140 4 28 11 52 17 52 11 0 4 -79 -12 -120 -6 -15 -31 -37 -62 -54 -28
    -16 -60 -36 -69 -44 -20 -16 -24 -62 -8 -78 20 -20 -14 -44 -76 -56 -97 -18
    -162 14 -223 111 -45 71 -71 164 -72 256 0 130 4 139 52 98 22 -18 95 -31 85
    -15 -4 7 -25 15 -48 18 l-40 7 5 41 c23 161 107 276 202 276 17 0 51 -10 75
    -22z m218 -316 c2 -8 -8 -12 -30 -12 -31 1 -32 1 -13 15 21 17 37 15 43 -3z"
        />
        <path
          d="M1305 1807 c-39 -67 -39 -67 -26 -67 6 0 23 18 37 40 l27 41 21 -31
    c17 -24 26 -29 47 -25 14 3 37 1 52 -4 23 -9 29 -6 52 21 21 25 28 29 36 17 5
    -8 9 -22 9 -31 0 -10 7 -18 16 -18 11 0 14 5 9 18 -4 9 -11 32 -17 50 -12 41
    -27 41 -57 -3 -22 -33 -25 -34 -70 -29 -36 5 -53 13 -76 40 l-30 33 -30 -52z"
        />
        <path
          d="M1375 1690 c-4 -7 -3 -16 3 -22 14 -14 45 -2 40 15 -6 16 -34 21 -43
    7z"
        />
        <path
          d="M1500 1671 c0 -15 6 -21 21 -21 25 0 22 33 -4 38 -12 2 -17 -3 -17
    -17z"
        />
        <path
          d="M1295 1625 c-5 -2 -23 -6 -39 -10 -42 -9 -18 -26 27 -18 20 3 37 9
    37 14 0 10 -12 17 -25 14z"
        />
        <path
          d="M1424 1605 c5 -18 2 -27 -9 -31 -21 -8 -7 -26 15 -19 10 3 21 1 24
    -4 7 -11 36 -4 36 9 0 4 -8 10 -19 13 -14 3 -17 11 -14 31 5 22 2 26 -17 26
    -19 0 -21 -4 -16 -25z"
        />
        <path
          d="M1292 1543 c9 -52 189 -91 258 -56 19 10 32 23 30 28 -6 12 -12 11
    -66 -9 -35 -13 -50 -13 -103 -2 -34 7 -75 23 -92 35 -28 21 -31 21 -27 4z"
        />
      </g>
    </svg>

        <h2>Dear Qatip User,</h2>
        <p>We are constantly working to enhance your experience and make <b>Qatip</b> the most efficient HR productivity assistant tool. 🚀</p>
        <hr style="margin: 10px 0;"/>
        <h3>🔍 What to expect:</h3>
        <ul style="list-style: none; padding: 0;">
          <li>✅ <b>New collaboration features</b> to boost teamwork.</li>
          <li>📊 <b>Advanced analytics</b> for data-driven decision-making.</li>
          <li>⚙️ <b>Customizable dashboards</b> to fit your workflow.</li>
        </ul>
        <p>Stay tuned for our upcoming updates, and thank you for being part of the <b>Qatip community</b>! 💙</p>
        <p>For support or feedback, feel free to reach out at: 
          <a href="mailto:support@qatip.app" style="color: #007BFF; text-decoration: underline;">support@qatip.app</a>
        </p>
        <p>Follow us for the latest updates:</p>
        <p>
          🌐 <a href="https://github.com/Qatip-App" target="_blank" style="color: #007BFF; text-decoration: underline;">GitHub</a><br>
          💼 <a href="https://www.linkedin.com/in/qatip-app/" target="_blank" style="color: #007BFF; text-decoration: underline;">LinkedIn</a>
        </p>
        <p>Best regards,<br><b>Qatip App Developer Team</b></p>
      </div>
    `,
    type: "info",
    category: "update",
    priority: "normal",
    icon: "bell",
    url: "/",
    actionText: "Learn More",
    to: "all",
    isHtml: true,
  };

  fs.writeFileSync(jsonFilePath, JSON.stringify(notificationData, null, 2));

  // 🌀 Construct the curl command
  const curlCommand = `
    curl -X POST https://us-central1-qatip-note-app.cloudfunctions.net/sendGeneralNotification \
    -H "Content-Type: application/json" \
    -d @${jsonFilePath}
  `;

  // 🚀 Execute the curl command
  exec(curlCommand, (error, stdout, stderr) => {
    if (error) {
      console.error("❌ Error sending notification:", error.message);
      return;
    }
    if (stderr) {
      console.error("⚠️ Stderr:", stderr);
      return;
    }
    console.log("✅ General notification sent successfully:", stdout);
  });
};

// ✨ Execute the function
sendGeneralNotification();
